<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <title>user List</title>
  <link rel="stylesheet" th:href="@{/css/custom.css}" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />


</head>

<body>

<div th:replace="fragments/header :: myHeader"></div>

  <div class="container border mt-5">


  <form id="regForm" th:action="@{/regformSub}" th:object="${regDto}" method="post" class="needs-validation"  novalidate>
  <div class="mb-3">
    <label>Name</label>
    <input type="text" th:field="*{name}" class="form-control" required minlength="2" maxlength="50" />
    <div class="invalid-feedback">
      Please enter your name (2-50 characters).
    </div>
  </div>

  <div class="mb-3">
    <label>Email</label>
    <input type="email" th:field="*{email}" class="form-control" required
       autocomplete="off"/>
    <div class="invalid-feedback">
      Please enter a valid email address.
    </div>
  </div>

  <div class="mb-3">
    <label>Password</label>
    <input type="password" th:field="*{user_pwd}" class="form-control" required minlength="6" />
     <span onclick="togglePassword1()" style="
        position: relative;
        left: 95%;
        top: -50px;
        transform: translateY(-110%);
        cursor: pointer;
    "> <i class="fa fa-eye" id="toggleIcon"></i>
       </span>
    <div class="invalid-feedback">
      Password must be at least 6 characters.
    </div>
  </div>

  <div class="mb-3">
    <label>Confirm Password</label>
    <input type="password" id="confirmPwd" th:field="*{confirmPwd}" class="form-control" required />
     <span onclick="togglePassword2()" style="
        position: relative;
        left: 95%;
        top: -50px;
        transform: translateY(-110%);
        cursor: pointer;
    "> <i class="fa fa-eye" id="toggleIcon"></i>
       </span>
    <div class="invalid-feedback" id="confirmPwdFeedback">
      Passwords must match.
    </div>
  </div>

  <button type="submit" class="btn btn-primary">Submit</button>
</form>

  </div>
</body>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
  function togglePassword1() {
    const passwordInput = document.getElementById("user_pwd");
    const type1 = passwordInput.getAttribute("type");

    if (type1 === "password" ) {
      passwordInput.setAttribute("type", "text");

    } else {
      passwordInput.setAttribute("type", "password");
    }

   
  }

  function togglePassword2() {
     const confirmPwd = document.getElementById("confirmPwd");
     const type2 = confirmPwd.getAttribute("type");

     if (type2 === "password") {
      confirmPwd.setAttribute("type", "text");

    } else {
      confirmPwd.setAttribute("type", "password");
    }
  }






$(document).ready(function () {
 let showSuccess = /*[[${success}]]*/ false;
  let msg = /*[['${message}']]*/ '';
// alert(showSuccess);
  if (showSuccess) {
    Swal.fire({
      icon: 'success',
      title: 'Success!',
      text: msg,
      confirmButtonText: 'OK'
    }).then(() => {
      window.location.href = '/'; // or wherever
    });
  }
});



//like document .ready function
  (() => {
    const form = document.getElementById('regForm');
    const confirmPwdInput = document.getElementById('confirmPwd');
    const confirmPwdFeedback = document.getElementById('confirmPwdFeedback');

    form.addEventListener('submit', function (event) {
      // Reset confirm password validation
      confirmPwdInput.classList.remove('is-invalid');
      confirmPwdFeedback.style.display = 'none';

      // Check confirm password matches password
      const pwd = form.querySelector('input[name="user_pwd"]').value;
      const confirmPwd = confirmPwdInput.value;

      if (confirmPwd !== pwd) {
        event.preventDefault();
        event.stopPropagation();

        confirmPwdInput.classList.add('is-invalid');
        confirmPwdFeedback.style.display = 'block';
      }

      if (!form.checkValidity()) {
        event.preventDefault();
        event.stopPropagation();
      }

      form.classList.add('was-validated');
    }, false);
  })();





  
</script>

</html>